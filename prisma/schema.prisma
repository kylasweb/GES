generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                 String              @id @default(cuid())
  email              String              @unique
  name               String?
  password           String
  phone              String?
  role               UserRole            @default(CUSTOMER)
  isActive           Boolean             @default(true)
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  addresses          Address[]
  giftCards          GiftCard[]
  orderNotes         OrderNote[]
  orders             Order[]
  productComparisons ProductComparison[]
  reviews            ProductReview[]
  quotes             Quote[]
  returns            Return[]
  warranties         Warranty[]
  auditTrails        AuditTrail[]

  @@map("users")
}

model Address {
  id          String      @id @default(cuid())
  userId      String
  type        AddressType
  name        String
  phone       String
  addressLine String
  city        String
  state       String
  postalCode  String
  country     String      @default("India")
  isDefault   Boolean     @default(false)
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  user        User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("addresses")
}

model Category {
  id          String    @id @default(cuid())
  name        String    @unique
  slug        String    @unique
  description String?
  image       String?
  isActive    Boolean   @default(true)
  sortOrder   Int       @default(0)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  products    Product[]

  @@map("categories")
}

model Brand {
  id          String    @id @default(cuid())
  name        String    @unique
  slug        String    @unique
  description String?
  logo        String?
  website     String?
  isActive    Boolean   @default(true)
  sortOrder   Int       @default(0)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  products    Product[]

  @@map("brands")
}

model ProductTag {
  id                  String                @id @default(cuid())
  name                String                @unique
  slug                String                @unique
  isActive            Boolean               @default(true)
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt
  ProductToProductTag ProductToProductTag[]

  @@map("product_tags")
}

model ProductAttribute {
  id                        String                      @id @default(cuid())
  name                      String
  slug                      String                      @unique
  type                      AttributeType               @default(TEXT)
  isVisible                 Boolean                     @default(true)
  isFilterable              Boolean                     @default(false)
  sortOrder                 Int                         @default(0)
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime                    @updatedAt
  ProductToProductAttribute ProductToProductAttribute[]
  values                    ProductAttributeValue[]

  @@map("product_attributes")
}

model ProductAttributeValue {
  id          String             @id @default(cuid())
  attributeId String
  value       String
  slug        String
  sortOrder   Int                @default(0)
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt
  attribute   ProductAttribute   @relation(fields: [attributeId], references: [id], onDelete: Cascade)
  variations  ProductVariation[] @relation("ProductAttributeValueToProductVariation")

  @@unique([attributeId, value])
  @@map("product_attribute_values")
}

model Product {
  id                        String                      @id @default(cuid())
  name                      String
  slug                      String                      @unique
  description               String
  shortDesc                 String?
  sku                       String                      @unique
  price                     Decimal                     @db.Decimal(10, 2)
  comparePrice              Decimal?                    @db.Decimal(10, 2)
  costPrice                 Decimal?                    @db.Decimal(10, 2)
  trackQuantity             Boolean                     @default(true)
  quantity                  Int                         @default(0)
  weight                    Decimal?                    @db.Decimal(8, 3)
  dimensions                Json?
  images                    Json
  tags                      Json?
  type                      ProductType                 @default(SIMPLE)
  isActive                  Boolean                     @default(true)
  featured                  Boolean                     @default(false)
  seoTitle                  String?
  seoDesc                   String?
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime                    @updatedAt
  categoryId                String
  brandId                   String?
  videos                    Json?
  customFields              Json?
  specifications            Json?
  ProductToProductAttribute ProductToProductAttribute[]
  ProductToProductTag       ProductToProductTag[]
  orderItems                OrderItem[]
  inventory                 ProductInventory?
  reviews                   ProductReview[]
  variations                ProductVariation[]
  brand                     Brand?                      @relation(fields: [brandId], references: [id])
  category                  Category                    @relation(fields: [categoryId], references: [id])
  stockAlerts               StockAlert[]
  warranties                Warranty[]

  @@map("products")
}

model ProductVariation {
  id              String                  @id @default(cuid())
  productId       String
  sku             String?                 @unique
  price           Decimal?                @db.Decimal(10, 2)
  comparePrice    Decimal?                @db.Decimal(10, 2)
  costPrice       Decimal?                @db.Decimal(10, 2)
  quantity        Int                     @default(0)
  weight          Decimal?                @db.Decimal(8, 3)
  dimensions      Json?
  image           String?
  isActive        Boolean                 @default(true)
  sortOrder       Int                     @default(0)
  createdAt       DateTime                @default(now())
  updatedAt       DateTime                @updatedAt
  orderItems      OrderItem[]
  product         Product                 @relation(fields: [productId], references: [id], onDelete: Cascade)
  attributeValues ProductAttributeValue[] @relation("ProductAttributeValueToProductVariation")

  @@map("product_variations")
}

model ProductInventory {
  id                String    @id @default(cuid())
  productId         String    @unique
  quantity          Int       @default(0)
  reserved          Int       @default(0)
  lowStockThreshold Int       @default(10)
  reorderPoint      Int       @default(5)
  lastRestocked     DateTime?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  product           Product   @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("product_inventory")
}

model ProductReview {
  id         String   @id @default(cuid())
  productId  String
  userId     String
  rating     Int
  title      String?
  content    String
  isVerified Boolean  @default(false)
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  product    Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([productId, userId])
  @@map("product_reviews")
}

model Order {
  id              String        @id @default(cuid())
  orderNumber     String        @unique
  userId          String?
  status          OrderStatus   @default(PENDING)
  paymentStatus   PaymentStatus @default(PENDING)
  paymentMethod   PaymentMethod
  currency        String        @default("INR")
  subtotal        Decimal       @db.Decimal(10, 2)
  taxAmount       Decimal       @default(0) @db.Decimal(10, 2)
  shippingAmount  Decimal       @default(0) @db.Decimal(10, 2)
  discountAmount  Decimal       @default(0) @db.Decimal(10, 2)
  totalAmount     Decimal       @db.Decimal(10, 2)
  notes           String?
  shippingAddress Json?
  billingAddress  Json?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  documents       Document[]
  items           OrderItem[]
  orderNotes      OrderNote[]
  user            User?         @relation(fields: [userId], references: [id])
  returns         Return[]
  transactions    Transaction[]
  warranties      Warranty[]

  @@map("orders")
}

model OrderItem {
  id                 String            @id @default(cuid())
  orderId            String
  productId          String
  productName        String
  productSku         String
  quantity           Int
  unitPrice          Decimal           @db.Decimal(10, 2)
  totalPrice         Decimal           @db.Decimal(10, 2)
  createdAt          DateTime          @default(now())
  productVariationId String?
  order              Order             @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product            Product           @relation(fields: [productId], references: [id])
  ProductVariation   ProductVariation? @relation(fields: [productVariationId], references: [id])

  @@map("order_items")
}

model Transaction {
  id                   String         @id @default(cuid())
  orderId              String
  gateway              PaymentGateway
  gatewayTransactionId String?        @unique
  gatewayStatus        String?
  amount               Decimal        @db.Decimal(10, 2)
  currency             String         @default("INR")
  paymentMethod        PaymentMethod
  metadata             Json?
  webhookReceived      Boolean        @default(false)
  webhookData          Json?
  createdAt            DateTime       @default(now())
  updatedAt            DateTime       @updatedAt
  gatewayResponse      Json?
  provider             String         @default("PHONEPE")
  status               String         @default("PENDING")
  transactionId        String         @unique
  refunds              Refund[]
  order                Order          @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@map("transactions")
}

model Refund {
  id            String      @id @default(cuid())
  refundId      String      @unique
  transactionId String
  amount        Decimal     @db.Decimal(10, 2)
  reason        String
  status        String      @default("PENDING")
  refundData    Json?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  transaction   Transaction @relation(fields: [transactionId], references: [id], onDelete: Cascade)

  @@map("refunds")
}

model Document {
  id        String       @id @default(cuid())
  orderId   String
  type      DocumentType
  name      String
  fileUrl   String
  fileSize  Int
  mimeType  String
  metadata  Json?
  createdAt DateTime     @default(now())
  order     Order        @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@map("documents")
}

model ContentBlock {
  id        String      @id @default(cuid())
  type      ContentType
  title     String?
  content   Json
  order     Int         @default(0)
  isActive  Boolean     @default(true)
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt

  @@map("content_blocks")
}

model Testimonial {
  id        String   @id @default(cuid())
  name      String
  role      String?
  company   String?
  content   String
  rating    Int
  image     String?
  isActive  Boolean  @default(true)
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("testimonials")
}

model Setting {
  id          String   @id @default(cuid())
  key         String   @unique
  value       Json
  description String?
  updatedAt   DateTime @updatedAt

  @@map("settings")
}

model SalesLedger {
  id            String        @id @default(cuid())
  orderId       String        @unique
  orderNumber   String
  date          DateTime      @default(now())
  description   String
  debitAmount   Decimal       @default(0) @db.Decimal(10, 2)
  creditAmount  Decimal       @default(0) @db.Decimal(10, 2)
  balance       Decimal       @db.Decimal(10, 2)
  category      String
  paymentMethod PaymentMethod
  createdAt     DateTime      @default(now())

  @@map("sales_ledger")
}

model Currency {
  id        String   @id @default(cuid())
  code      String   @unique
  name      String
  symbol    String
  rate      Decimal  @db.Decimal(10, 6)
  isDefault Boolean  @default(false)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("currencies")
}

model Coupon {
  id            String     @id @default(cuid())
  code          String     @unique
  description   String?
  type          CouponType @default(PERCENTAGE)
  value         Decimal    @db.Decimal(10, 2)
  minOrderValue Decimal?   @db.Decimal(10, 2)
  maxDiscount   Decimal?   @db.Decimal(10, 2)
  usageLimit    Int?
  usageCount    Int        @default(0)
  perUserLimit  Int?
  validFrom     DateTime
  validUntil    DateTime
  isActive      Boolean    @default(true)
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt

  @@map("coupons")
}

model Deal {
  id          String   @id @default(cuid())
  productId   String
  title       String
  description String?
  discount    Decimal  @db.Decimal(5, 2)
  startDate   DateTime
  endDate     DateTime
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("deals")
}

model Newsletter {
  id        String           @id @default(cuid())
  email     String           @unique
  name      String?
  status    SubscriberStatus @default(ACTIVE)
  source    String?
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt

  @@map("newsletters")
}

model Wallet {
  id           String              @id @default(cuid())
  userId       String              @unique
  balance      Decimal             @default(0) @db.Decimal(10, 2)
  createdAt    DateTime            @default(now())
  updatedAt    DateTime            @updatedAt
  transactions WalletTransaction[]

  @@map("wallets")
}

model WalletTransaction {
  id          String                @id @default(cuid())
  walletId    String
  type        WalletTransactionType
  amount      Decimal               @db.Decimal(10, 2)
  balance     Decimal               @db.Decimal(10, 2)
  description String
  reference   String?
  createdAt   DateTime              @default(now())
  wallet      Wallet                @relation(fields: [walletId], references: [id], onDelete: Cascade)

  @@map("wallet_transactions")
}

model LoyaltyPoint {
  id             String   @id @default(cuid())
  userId         String   @unique
  points         Int      @default(0)
  lifetimePoints Int      @default(0)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@map("loyalty_points")
}

model ShippingMethod {
  id          String       @id @default(cuid())
  name        String
  description String?
  type        ShippingType @default(FLAT_RATE)
  cost        Decimal      @db.Decimal(10, 2)
  minOrder    Decimal?     @db.Decimal(10, 2)
  maxOrder    Decimal?     @db.Decimal(10, 2)
  cities      Json?
  isActive    Boolean      @default(true)
  sortOrder   Int          @default(0)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  @@map("shipping_methods")
}

model BlogPost {
  id          String    @id @default(cuid())
  title       String
  slug        String    @unique
  excerpt     String?
  content     String
  image       String?
  authorId    String?
  categoryId  String?
  tags        Json?
  seoTitle    String?
  seoDesc     String?
  isPublished Boolean   @default(false)
  publishedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  @@map("blog_posts")
}

model SupportTicket {
  id           String         @id @default(cuid())
  userId       String?
  ticketNumber String         @unique
  subject      String
  description  String
  status       TicketStatus   @default(OPEN)
  priority     TicketPriority @default(MEDIUM)
  category     String?
  email        String
  name         String
  responses    Json?
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt

  @@map("support_tickets")
}

model Media {
  id           String    @id @default(cuid())
  filename     String
  originalName String
  mimeType     String
  size         Int
  width        Int?
  height       Int?
  url          String
  thumbnailUrl String?
  alt          String?
  caption      String?
  type         MediaType @default(IMAGE)
  folder       String?
  tags         String[]
  uploadedBy   String?
  usageCount   Int       @default(0)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  @@index([type])
  @@index([folder])
  @@index([createdAt])
  @@map("media")
}

model LandingTemplate {
  id           String        @id @default(cuid())
  name         String
  slug         String        @unique
  description  String?
  thumbnail    String?
  isActive     Boolean       @default(false)
  config       Json?
  features     String[]
  colorScheme  String        @default("light")
  tags         String[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  siteSettings SiteSettings?

  @@map("landing_templates")
}

model SiteSettings {
  id               String           @id @default(cuid())
  siteName         String           @default("Green Energy Solutions")
  siteDescription  String?
  contactEmail     String?
  contactPhone     String?
  activeTemplateId String?          @unique
  maintenanceMode  Boolean          @default(false)
  config           Json?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  footerStyle      String           @default("default")
  headerStyle      String           @default("default")
  menuStyle        String           @default("default")
  smtpFromEmail    String?
  smtpFromName     String?
  smtpHost         String?
  smtpPassword     String?
  smtpPort         Int?             @default(587)
  smtpSecure       Boolean          @default(false)
  smtpUser         String?
  activeTemplate   LandingTemplate? @relation(fields: [activeTemplateId], references: [id])

  @@map("site_settings")
}

model FeatureFlag {
  id          String   @id @default(cuid())
  key         String   @unique
  name        String
  description String?
  enabled     Boolean  @default(false)
  rollout     Int      @default(100)
  config      Json?
  category    String?
  createdBy   String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([enabled])
  @@map("feature_flags")
}

model GitVersion {
  id            String   @id @default(cuid())
  version       String   @unique
  commitHash    String   @unique
  commitMessage String?
  branch        String   @default("main")
  author        String?
  deployedBy    String?
  deployedAt    DateTime @default(now())
  isActive      Boolean  @default(false)
  changelog     String[]
  environment   String   @default("production")
  buildNumber   Int      @default(autoincrement())
  rollbackable  Boolean  @default(true)
  metadata      Json?

  @@index([deployedAt])
  @@index([isActive])
  @@index([environment])
  @@map("git_versions")
}

model Chat {
  id                      String            @id @default(cuid())
  visitorName             String?
  visitorEmail            String?
  visitorPhone            String?
  sessionId               String            @unique
  status                  ChatStatus        @default(ACTIVE)
  assignedTo              String?
  startedAt               DateTime          @default(now())
  endedAt                 DateTime?
  lastMessageAt           DateTime          @default(now())
  metadata                Json?
  department              String?           @default("general")
  emailNotificationSent   Boolean           @default(false)
  firstResponseAt         DateTime?
  isOfflineMessage        Boolean           @default(false)
  offlineNotificationSent Boolean           @default(false)
  rating                  Int?
  ratingComment           String?
  resolutionTime          Int?
  resolvedAt              DateTime?
  responseTime            Int?
  analytics               ChatAnalytics?
  messages                ChatMessage[]
  participants            ChatParticipant[]

  @@index([status])
  @@index([department])
  @@index([assignedTo])
  @@index([lastMessageAt])
  @@index([isOfflineMessage])
  @@map("chats")
}

model ChatMessage {
  id          String      @id @default(cuid())
  chatId      String
  senderId    String?
  senderType  SenderType
  message     String
  messageType MessageType @default(TEXT)
  metadata    Json?
  isRead      Boolean     @default(false)
  createdAt   DateTime    @default(now())
  fileName    String?
  fileSize    Int?
  fileUrl     String?
  chat        Chat        @relation(fields: [chatId], references: [id], onDelete: Cascade)

  @@index([chatId])
  @@index([createdAt])
  @@map("chat_messages")
}

model ChatParticipant {
  id       String          @id @default(cuid())
  chatId   String
  userId   String?
  role     ParticipantRole
  joinedAt DateTime        @default(now())
  leftAt   DateTime?
  isActive Boolean         @default(true)
  chat     Chat            @relation(fields: [chatId], references: [id], onDelete: Cascade)

  @@unique([chatId, userId])
  @@index([chatId])
  @@index([userId])
  @@map("chat_participants")
}

model ChatKnowledgeBase {
  id         String   @id @default(cuid())
  title      String
  content    String
  keywords   String[]
  category   String?
  isActive   Boolean  @default(true)
  sortOrder  Int      @default(0)
  views      Int      @default(0)
  helpful    Int      @default(0)
  notHelpful Int      @default(0)
  createdBy  String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([isActive])
  @@index([category])
  @@map("chat_knowledge_base")
}

model ChatAnalytics {
  id                   String   @id @default(cuid())
  chatId               String   @unique
  totalMessages        Int      @default(0)
  visitorMessages      Int      @default(0)
  adminMessages        Int      @default(0)
  avgResponseTime      Int?
  longestResponseTime  Int?
  shortestResponseTime Int?
  sessionDuration      Int?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  chat                 Chat     @relation(fields: [chatId], references: [id], onDelete: Cascade)

  @@index([chatId])
  @@map("chat_analytics")
}

model ChatDepartment {
  id          String   @id @default(cuid())
  name        String   @unique
  slug        String   @unique
  description String?
  email       String?
  isActive    Boolean  @default(true)
  sortOrder   Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("chat_departments")
}

model AdminPresence {
  id         String   @id @default(cuid())
  userId     String   @unique
  isOnline   Boolean  @default(false)
  lastSeenAt DateTime @default(now())
  socketId   String?
  department String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([isOnline])
  @@index([department])
  @@map("admin_presence")
}

model AuditTrail {
  id        String   @id @default(cuid())
  userId    String
  tableName String
  recordId  String
  action    String // INSERT, UPDATE, DELETE
  oldValues Json?
  newValues Json?
  timestamp DateTime @default(now())
  ipAddress String?
  userAgent String?
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([tableName])
  @@index([timestamp])
  @@index([action])
  @@map("audit_trail")
}

model Return {
  id           String       @id @default(cuid())
  orderId      String
  userId       String
  returnNumber String       @unique
  reason       ReturnReason
  description  String?
  items        Json
  status       ReturnStatus @default(PENDING)
  refundAmount Decimal      @db.Decimal(10, 2)
  refundMethod RefundMethod @default(ORIGINAL_PAYMENT)
  images       Json?
  adminNotes   String?
  trackingCode String?
  returnLabel  String?
  requestedAt  DateTime     @default(now())
  approvedAt   DateTime?
  completedAt  DateTime?
  rejectedAt   DateTime?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  order        Order        @relation(fields: [orderId], references: [id], onDelete: Cascade)
  user         User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([orderId])
  @@index([status])
  @@map("returns")
}

model Warranty {
  id             String          @id @default(cuid())
  orderId        String
  productId      String
  userId         String
  warrantyNumber String          @unique
  purchaseDate   DateTime
  warrantyPeriod Int
  expiryDate     DateTime
  status         WarrantyStatus  @default(ACTIVE)
  documents      Json?
  registeredAt   DateTime        @default(now())
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  order          Order           @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product        Product         @relation(fields: [productId], references: [id], onDelete: Cascade)
  user           User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  claims         WarrantyClaim[]

  @@index([userId])
  @@index([productId])
  @@index([status])
  @@map("warranties")
}

model WarrantyClaim {
  id          String      @id @default(cuid())
  warrantyId  String
  claimNumber String      @unique
  issue       String
  description String
  images      Json?
  status      ClaimStatus @default(SUBMITTED)
  resolution  String?
  adminNotes  String?
  submittedAt DateTime    @default(now())
  resolvedAt  DateTime?
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  warranty    Warranty    @relation(fields: [warrantyId], references: [id], onDelete: Cascade)

  @@index([warrantyId])
  @@index([status])
  @@map("warranty_claims")
}

model StockAlert {
  id         String      @id @default(cuid())
  productId  String
  email      String
  status     AlertStatus @default(PENDING)
  notifiedAt DateTime?
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  product    Product     @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([status])
  @@map("stock_alerts")
}

model Quote {
  id                 String      @id @default(cuid())
  quoteNumber        String      @unique
  userId             String?
  email              String
  name               String
  phone              String?
  company            String?
  items              Json
  message            String?
  status             QuoteStatus @default(PENDING)
  quotedAmount       Decimal?    @db.Decimal(10, 2)
  validUntil         DateTime?
  adminNotes         String?
  convertedToOrderId String?     @unique
  createdAt          DateTime    @default(now())
  updatedAt          DateTime    @updatedAt
  user               User?       @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([status])
  @@map("quotes")
}

model GiftCard {
  id             String                @id @default(cuid())
  code           String                @unique
  initialValue   Decimal               @db.Decimal(10, 2)
  balance        Decimal               @db.Decimal(10, 2)
  currency       String                @default("INR")
  purchasedBy    String?
  recipientEmail String?
  recipientName  String?
  message        String?
  status         GiftCardStatus        @default(ACTIVE)
  expiresAt      DateTime?
  createdAt      DateTime              @default(now())
  updatedAt      DateTime              @updatedAt
  transactions   GiftCardTransaction[]
  purchaser      User?                 @relation(fields: [purchasedBy], references: [id])

  @@index([code])
  @@index([status])
  @@map("gift_cards")
}

model GiftCardTransaction {
  id         String   @id @default(cuid())
  giftCardId String
  orderId    String?
  amount     Decimal  @db.Decimal(10, 2)
  balance    Decimal  @db.Decimal(10, 2)
  type       String
  createdAt  DateTime @default(now())
  giftCard   GiftCard @relation(fields: [giftCardId], references: [id], onDelete: Cascade)

  @@index([giftCardId])
  @@map("gift_card_transactions")
}

model OrderNote {
  id         String   @id @default(cuid())
  orderId    String
  userId     String
  note       String
  isInternal Boolean  @default(false)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  order      Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([orderId])
  @@map("order_notes")
}

model ProductComparison {
  id         String   @id @default(cuid())
  userId     String?
  sessionId  String
  productIds Json
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  user       User?    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([sessionId])
  @@map("product_comparisons")
}

model ProductToProductAttribute {
  A                  String
  B                  String
  products           Product          @relation(fields: [A], references: [id], onDelete: Cascade)
  product_attributes ProductAttribute @relation(fields: [B], references: [id], onDelete: Cascade)

  @@id([A, B], map: "_ProductToProductAttribute_AB_pkey")
  @@index([B], map: "_ProductToProductAttribute_B_index")
  @@map("_ProductToProductAttribute")
}

model ProductToProductTag {
  A            String
  B            String
  products     Product    @relation(fields: [A], references: [id], onDelete: Cascade)
  product_tags ProductTag @relation(fields: [B], references: [id], onDelete: Cascade)

  @@id([A, B], map: "_ProductToProductTag_AB_pkey")
  @@index([B], map: "_ProductToProductTag_B_index")
  @@map("_ProductToProductTag")
}

enum UserRole {
  CUSTOMER
  CONTENT_MANAGER
  ORDER_MANAGER
  FINANCE_MANAGER
  SUPER_ADMIN
}

enum AddressType {
  SHIPPING
  BILLING
}

enum OrderStatus {
  PENDING
  AWAITING_PAYMENT
  COD_PENDING
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
  REFUNDED
}

enum PaymentStatus {
  PENDING
  PAID
  FAILED
  REFUNDED
  PARTIALLY_REFUNDED
}

enum PaymentMethod {
  PHONEPE
  COD
  UPI
  CREDIT_CARD
  DEBIT_CARD
  NET_BANKING
}

enum PaymentGateway {
  PHONEPE
  RAZORPAY
  STRIPE
  PAYPAL
  MANUAL
}

enum DocumentType {
  INVOICE
  SHIPPING_LABEL
  PACKING_SLIP
  RECEIPT
  REFUND_NOTE
}

enum ContentType {
  HERO_BANNER
  FEATURED_PRODUCTS
  TESTIMONIALS
  CATEGORIES
  INFO_SECTION
  PROMOTION_BANNER
}

enum AttributeType {
  TEXT
  COLOR
  IMAGE
  SELECT
}

enum ProductType {
  SIMPLE
  VARIABLE
  GROUPED
  EXTERNAL
  DIGITAL
  CLASSIFIED
}

enum ReturnReason {
  DEFECTIVE
  WRONG_ITEM
  NOT_AS_DESCRIBED
  CHANGED_MIND
  ARRIVED_LATE
  DAMAGED
  OTHER
}

enum ReturnStatus {
  PENDING
  APPROVED
  REJECTED
  IN_TRANSIT
  RECEIVED
  COMPLETED
  CANCELLED
}

enum RefundMethod {
  ORIGINAL_PAYMENT
  STORE_CREDIT
  BANK_TRANSFER
  GIFT_CARD
}

enum WarrantyStatus {
  ACTIVE
  EXPIRED
  CLAIMED
  VOID
}

enum ClaimStatus {
  SUBMITTED
  UNDER_REVIEW
  APPROVED
  REJECTED
  IN_REPAIR
  COMPLETED
}

enum AlertStatus {
  PENDING
  NOTIFIED
  CANCELLED
}

enum QuoteStatus {
  PENDING
  QUOTED
  ACCEPTED
  REJECTED
  EXPIRED
  CONVERTED
}

enum GiftCardStatus {
  ACTIVE
  USED
  EXPIRED
  CANCELLED
}

enum CouponType {
  PERCENTAGE
  FIXED
}

enum SubscriberStatus {
  ACTIVE
  UNSUBSCRIBED
}

enum WalletTransactionType {
  CREDIT
  DEBIT
  REFUND
}

enum ShippingType {
  FLAT_RATE
  PRODUCT_WISE
  CITY_WISE
  FREE
  PICKUP_POINT
}

enum TicketStatus {
  OPEN
  IN_PROGRESS
  AWAITING_CUSTOMER
  RESOLVED
  CLOSED
}

enum TicketPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum MediaType {
  IMAGE
  VIDEO
  DOCUMENT
  OTHER
}

enum ChatStatus {
  ACTIVE
  WAITING
  ASSIGNED
  RESOLVED
  CLOSED
}

enum SenderType {
  VISITOR
  ADMIN
  SYSTEM
}

enum MessageType {
  TEXT
  IMAGE
  FILE
  KNOWLEDGE_BASE
  SYSTEM
}

enum ParticipantRole {
  VISITOR
  ADMIN
  OBSERVER
}
